console.log("filters ready");const statusSelect=document.querySelector(".status__select"),genreSelect=document.querySelector(".genre__select");function statusFilter(e){if(null!==resultList&&0!==resultList.length){const t=e.currentTarget.value,n="Running",s="Ended",r="To Be Determined",a="In Development";if("4"===t){const e=resultList.filter(e=>e.dataset.status===a);resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("3"===t){const e=resultList.filter(e=>e.dataset.status===r);resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("2"===t){const e=resultList.filter(e=>e.dataset.status===s);resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("1"===t){const e=resultList.filter(e=>e.dataset.status===n);resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else search()}}function genreFilter(){if(null!==resultList&&0!==resultList.length){console.log(resultList);const e=event.currentTarget.value,t="Action",n="Adult",s="Adventure",r="Anime",a="Children",i="Comedy",o="Crime",l="DIY",d="Drama",f="Espionage",u="Family",c="Fantasy",g="Food",C="History",p="Horror",L="Legal",h="Medical",m="Music",v="Mystery",T="Nature",w="Romance",x="Science-Fiction",M="Sports",H="Supernatural",O="Thriller",S="Travel",y="War",_="Western</ocon";if("3"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(t)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("19"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(n)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("4"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(s)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("5"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(r)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("6"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(a)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("2"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(i)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("8"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(o)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("24"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(l)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("1"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(d)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("25"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(f)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("9"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(u)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("10"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(c)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("7"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(g)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("23"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(C)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("11"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(p)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("27"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(L)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("22"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(h)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("12"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(m)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("18"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(v)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("20"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(T)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("13"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(w)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("14"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(x)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("20"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(T)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("13"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(w)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("14"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(x)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("26"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(M)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("28"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(H)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("15"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(O)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("21"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(S)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("16"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(y)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else if("17"===e){const e=resultList.filter(e=>{if(e.dataset.genere.indexOf(_)>-1)return e.dataset.genere});resultsContainer.innerHTML="";for(const t of e)resultsContainer.appendChild(t)}else search()}}statusSelect.addEventListener("change",statusFilter),genreSelect.addEventListener("change",genreFilter);const inputText=document.querySelector(".js__inputText"),btn=document.querySelector(".js__searchBtn"),favContainer=document.querySelector(".js__fav"),resultsContainer=document.querySelector(".js__results"),resetBtn=document.querySelector(".reset__btn"),allFavs=document.querySelector(".favContainer"),resultNumber=document.querySelector(".resultnumber__text"),numArray=[5,8,10];let resultList=[],favs=[],favsarray=JSON.parse(localStorage.getItem("favoriteShowsArray"));function init(){writeFav()}function createNewElement(e,t,n,s,r){const a=createNewDiv("div","show__wrapper",n),i=document.createElement("h3"),o=document.createTextNode(s);i.appendChild(o),i.classList.add("showTitle"),a.appendChild(i);const l=createNewLink("a","urlLink",r);a.appendChild(l);const d=document.createElement(e);return d.classList.add(t),d.setAttribute("data-id",n),d.appendChild(a),d}function createNewDiv(e,t,n){const s=document.createElement(e);return s.classList.add(t),s.setAttribute("data-id",n),s}function createNewTitle(e,t,n){const s=document.createElement(e);s.classList.add(t);const r=document.createTextNode(n);return s.appendChild(r),s}function createNewImage(e,t,n,s){const r=document.createElement(e);return r.src=n,r.alt=s,r.classList.add(t),r}function createNewLink(e,t,n){const s=document.createElement(e);s.setAttribute("target","__blank");const r=document.createTextNode("?");return s.appendChild(r),s.classList.add(t),s.href=n,s}function compare(e,t){const n=e.name.toUpperCase(),s=t.name.toUpperCase();let r=0;return n>s?r=1:n<s&&(r=-1),r}function writeFav(){favContainer.innerHTML="";let e=JSON.parse(localStorage.getItem("favoriteShowsArray"));if(null!==e)if(0===e.length)allFavs.classList.add("hidden");else{allFavs.classList.remove("hidden"),e.sort(compare);for(const t of e){const e=createNewDiv("div","fav_TitleWrapper",t.id),n=createNewTitle("h3","fav__ShowTitle",t.name),s=document.createElement("button");s.classList.add("closeBtn"),s.addEventListener("click",remove),e.appendChild(n),e.appendChild(s);const r=createNewImage("img","favImg",t.img,t.name),a=createNewDiv("div","favShow",t.id);a.appendChild(e),a.appendChild(r),favContainer.appendChild(a)}}else allFavs.classList.add("hidden")}function addFavs(e){let t=e.target,n=e.currentTarget;if(!t.classList.contains("urlLink")){const e=n.getAttribute("data-id"),t=n.querySelector(".img").src,s=n.querySelector(".showTitle").innerHTML,r=n.getAttribute("data-lang"),a=n.getAttribute("data-status"),i=n.getAttribute("data-genres"),o=n.getAttribute("data-score"),l={id:e,name:s,img:t,lang:r,status:a,genere:i,score:o};if(n.classList.toggle("show__fav"),null!==favs&&0!==favs.length){let t=favs.find(t=>t.id===e);if(void 0===t)favs.push(l);else{const e=favs.indexOf(t);e>-1&&favs.splice(e,1)}}else(favs=[]).push(l);saveToLocalStorage(),writeFav()}}function saveToLocalStorage(){localStorage.setItem("favoriteShowsArray",JSON.stringify(favs))}function remove(e){const t=e.currentTarget.parentElement.parentElement.getAttribute("data-id");let n=favs.find(e=>e.id===t);const s=favs.indexOf(n);s>-1&&favs.splice(s,1),resultsContainer.querySelector(`[data-id="${t}"]`).classList.toggle("show__fav"),saveToLocalStorage(),writeFav()}function cleanAll(){favs=[],localStorage.clear(),writeFav();const e=document.querySelectorAll(".show__fav");for(const t of e)t.classList.toggle("show__fav")}function search(){const e=inputText.value;fetch(`http://api.tvmaze.com/search/shows?q=${e}`).then(e=>e.json()).then(e=>{resultsContainer.innerHTML="",resultList=[],resultNumber.innerHTML=e.length;for(const t of e){const e=createNewElement("li","show",`${t.show.id}`,t.show.name,`${t.show.url}`),n=t.score,s=t.show.language,r=t.show.status,a=t.show.genres;e.setAttribute("data-lang",s),e.setAttribute("data-status",r),e.setAttribute("data-genere",a),e.setAttribute("data-score",n);const i=createNewTitle("time","time",t.show.premiered);if(null!==t.show.image){const n=createNewImage("img","img",t.show.image.medium,t.show.title);e.appendChild(n)}else{const n=createNewImage("img","img","https://via.placeholder.com/210x295/ffffff/666666/?text=TV",t.show.title);e.appendChild(n)}e.appendChild(i),resultList.push(e)}for(const e of resultList){const t=e.getAttribute("data-id");if(null!==favs&&0!==favs.length){void 0!==favs.find(e=>e.id===t)&&e.classList.toggle("show__fav")}resultsContainer.appendChild(e)}const t=document.querySelectorAll(".show");for(const e of t)e.addEventListener("click",addFavs)})}function fakeClick(e){13===e.keyCode&&search()}function showResults(){const e=parseInt(resultNumber.innerHTML);for(const t of numArray)t<=e?console.log(`El numero de resultados es ${e} y es mayor o igual a ${t}`):console.log(`El numero de resultados es ${e} y es menor a ${t}`)}null!==favsarray&&(favs=favsarray),inputText.addEventListener("keyup",fakeClick),resetBtn.addEventListener("click",cleanAll),btn.addEventListener("click",search),resultNumber.addEventListener("click",showResults),init();